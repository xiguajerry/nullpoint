package me.nullpoint.mod.modules.impl.exploit;

import me.nullpoint.api.events.eventbus.EventHandler;
import me.nullpoint.api.events.impl.PacketEvent;
import me.nullpoint.mod.modules.Beta;
import me.nullpoint.mod.modules.Module;
import me.nullpoint.mod.modules.settings.impl.SliderSetting;
import net.minecraft.network.packet.c2s.play.PlayerMoveC2SPacket;

@Beta
public class PacketControl extends Module {
   public static PacketControl INSTANCE;
   private final SliderSetting fullPackets = this.add(new SliderSetting("FullPackets", 15, 1, 50));
   private final SliderSetting positionPackets = this.add(new SliderSetting("PositionPackets", 15, 1, 50));
   private int fullPacket;
   private int positionPacket;
   public boolean full;

   public PacketControl() {
      super("PacketControl", Module.Category.Exploit);
      INSTANCE = this;
   }

   @EventHandler
   public final void onPacketSend(PacketEvent.Send event) {
      if (event.getPacket() instanceof PlayerMoveC2SPacket.PositionAndOnGround && !this.full) {
         ++this.positionPacket;
         if ((double)this.positionPacket >= this.positionPackets.getValue()) {
            this.positionPacket = 0;
            this.full = true;
         }
      } else if (event.getPacket() instanceof PlayerMoveC2SPacket.Full && this.full) {
         ++this.fullPacket;
         if ((double)this.fullPacket > this.fullPackets.getValue()) {
            this.fullPacket = 0;
            this.full = false;
         }
      }

   }
}
